<!-- -->
<div class="new">
  <div class="form">
    <input
      type="file"
      #inputFile
      multiple
      [max]="maxCounterFile"
      class="input__file product__input"
      (change)="onFileUpload($event)"
      accept="image/jpeg,image/png"
    />
    <!--  -->
    <button
      mat-raised-button
      color="primary"
      (click)="test()"
      style="margin-left: 15px"
    >
      TEST FUNCTION
    </button>
    <div class="product__content">
      <div class="product__content-body">
        <!-- ============================================================== -->
        <div class="new__item new__photo">
          <div class="new__item-title">
            <p class="title">Фото вашого товару*</p>
          </div>

          <div class="example-button-row">
            <button mat-raised-button color="primary" (click)="triggerClick()">
              Завантажити фото
              <span class="material-symbols-outlined"> file_download </span>
            </button>
          </div>

          <span class="error__input" *ngIf="validImages"
            >Фото товара є обов'язковим.</span
          >
        </div>
        <!-- ============================================================== -->
        <div class="new__item new__name">
          <div class="new__item-title">
            <p class="title">Назва товару*</p>
          </div>
          <mat-form-field
            class="example-full-width width-input"
            appearance="fill"
          >
            <mat-label>Назва товару</mat-label>
            <input
              matInput
              type="text"
              #inputTitle
              required
              id="name"
              [(ngModel)]="nameProduct"
            />
          </mat-form-field>
        </div>
        <!-- ============================================================== -->
        <div class="new__item new__price">
          <div class="new__item-title">
            <p class="title">Ціна товару*</p>
          </div>
          <mat-form-field
            class="example-full-width width-input"
            appearance="fill"
          >
            <mat-label>Ціна товару</mat-label>
            <input
              matInput
              type="number"
              class="price__input"
              #inputPrice
              required
              placeholder="3 489"
              [(ngModel)]="priceProduct"
              (ngModelChange)="procentActionNumber()"
            />
          </mat-form-field>
          <!--  -->
        </div>
        <!-- ============================================================== -->
        <div class="new__item new__action">
          <div class="new__item-title">
            <p class="title">Акція на товар*</p>
          </div>
          <mat-checkbox [(ngModel)]="action">Акція на товар</mat-checkbox>
          <div class="new__action-price__procent" *ngIf="action">
            <p *ngIf="actionProcent <= minActionProcent">
              Знижка {{ actionProcent }}%
            </p>
            <p *ngIf="actionProcent > minActionProcent">
              Мінімальна знижка на товар {{ minActionProcent }}%
            </p>
          </div>
          <div class="new__action-price" *ngIf="action">
            <mat-form-field
              class="example-full-width width-input"
              appearance="fill"
            >
              <mat-label>Акційна ціна</mat-label>
              <input
                matInput
                type="number"
                class="price__input-action"
                required
                [(ngModel)]="actionPrice"
                #actionPriceInput
                (ngModelChange)="procentActionNumber()"
              />
            </mat-form-field>
          </div>
        </div>
        <!-- ============================================================== -->
        <div class="new__item new__counter">
          <div class="new__item-title">
            <p class="title">Кількість товару*</p>
          </div>
          <mat-form-field
            class="example-full-width width-input"
            appearance="fill"
          >
            <mat-label>Кількість товару в наявності</mat-label>
            <input
              matInput
              [(ngModel)]="counterProduct"
              type="number"
              class="counter__input"
              required
            />
          </mat-form-field>
        </div>
        <!-- ============================================================== -->
        <div class="new__item new__category">
          <div class="new__item-title">
            <p class="title">Категорія товару*</p>
          </div>
          <div class="new__category-block" (click)="popuapOpen()">
            <!--  -->
            <div class="category__select" *ngIf="!categorySelected">
              <p class="category__select-title">Категорія не вибрана</p>
            </div>
            <!--  -->
            <div class="category" *ngIf="categorySelected">
              <p class="category__title">
                {{ categoryList[oneIndex].nameCategory }}
              </p>
              <span>&nbsp;/&nbsp;</span>
              <p class="category__title">
                {{
                  categoryList[oneIndex].nameListCategory[twoIndex]
                    .subNameCategory
                }}
              </p>
              <span *ngIf="categoryNumber.length === 3">&nbsp;/&nbsp;</span>
              <p class="category__title" *ngIf="categoryNumber.length === 3">
                {{
                  categoryList[oneIndex].nameListCategory[twoIndex]
                    .subNameListCategory[0].titleSubNameListCategory
                }}
              </p>
            </div>
            <!--  -->
          </div>

          <div class="category__error" *ngIf="categoryErrorShow">
            <span class="error__category"> Виберіть категорію товара </span>
          </div>
        </div>
        <!-- ============================================================== -->
        <div class="new__item new__characteristics" *ngIf="categorySelected">
          <div class="new__item-title">
            <p class="title">Характеристики товару*</p>
          </div>

          <div class="new__characteristics-block">
            <ng-container
              *ngFor="let options of characteristics; let idx = index"
            >
              <div class="item">
                <mat-form-field appearance="fill">
                  <mat-label>№{{ idx }}&nbsp;{{ options.name }}</mat-label>
                  <mat-select
                    disableRipple
                    class="select__params"
                    #selectedValue
                    [(ngModel)]="optionsListNumber[idx]"
                    (ngModelChange)="valueChangeSelect()"
                    required
                  >
                    <mat-option [value]="-1">-1-Параметр не вибрано</mat-option>
                    <ng-container
                      *ngFor="let option of options.select; let i = index"
                    >
                      <mat-option [value]="i">{{
                        i + "-" + option
                      }}</mat-option>
                    </ng-container>
                  </mat-select>
                </mat-form-field>
                <!--  -->
              </div>
            </ng-container>
          </div>
        </div>
        <!-- ============================================================== -->
        <div class="new__item new__unique__params" *ngIf="categorySelected">
          <div class="new__item-title">
            <p class="title">Ключовий параметр*</p>
          </div>

          <mat-form-field appearance="fill">
            <mat-label>Ключовий параметр</mat-label>
            <mat-select
              disableRipple
              class="select__params"
              #selectedValue
              [(ngModel)]="uniqueParamsNumber"
              required
            >
              <mat-option
                [value]="idx"
                *ngFor="let unique of uniqueParams; let idx = index"
                >{{ unique }}</mat-option
              >
            </mat-select>
          </mat-form-field>
        </div>
        <!-- ============================================================== -->
        <div class="new__item new__status">
          <div class="new__item-title">
            <p class="title">Статус товару*</p>
          </div>
          <mat-form-field appearance="fill">
            <mat-label>Статус товару</mat-label>
            <mat-select
              disableRipple
              class="select__params"
              required
              [(ngModel)]="statusNumber"
            >
              <mat-option [value]="0">В наявності</mat-option>
              <mat-option [value]="1">Очікується постачання</mat-option>
              <mat-option [value]="2">Немає в наявності</mat-option>
              <mat-option [value]="3">Закінчується</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <!-- ============================================================== -->
        <div class="new__item new__seller">
          <div class="new__item-title">
            <p class="title">Виберіть продавця*</p>
          </div>
          <mat-form-field appearance="fill">
            <mat-label>Вибиріть продавця</mat-label>
            <mat-select
              disableRipple
              class="select__params"
              [(ngModel)]="sellerNumber"
              required
            >
              <mat-option
                [value]="idx"
                *ngFor="let seller of sellerList; let idx = index"
                >{{ seller.name }}</mat-option
              >
            </mat-select>
          </mat-form-field>
        </div>
        <!-- ============================================================== -->
        <div class="new__item new__words">
          <div class="new__item-title">
            <p class="title">
              Введіть ключові слова для товару через пробіл, не більше 200
              символів (не обов'язково)
            </p>
          </div>
          <mat-form-field
            class="example-full-width input-width-keywords"
            appearance="fill"
          >
            <mat-label>Ключові слова</mat-label>
            <textarea
              matInput
              type="text"
              class="input-keywords"
              [(ngModel)]="stringKeysWords"
              #inputKeyWords
              (keyup)="keyWordsInput(inputKeyWords.value)"
            ></textarea>
          </mat-form-field>
          <!--  -->
          <div class="symbol">
            <span [ngClass]="{ error__input: lengthKeyWords > 200 }"
              >Символів <span>{{ lengthKeyWords }}</span> <span>/</span>
              <span>200</span></span
            >
          </div>
          <!--  -->
          <div class="display__symbol">
            <ng-container *ngFor="let word of keyWords">
              <div
                class="display__symbol-word"
                *ngIf="word.length >= 1"
                [ngClass]="{
                  error__keywords:
                    word.length < minWordLength || word.length > maxWordLength
                }"
                [title]="
                  word.length < minWordLength
                    ? 'Мінімальна кількість символів ' + minWordLength
                    : word.length > maxWordLength
                    ? 'Максимальна кількість символів ' + maxWordLength
                    : ''
                "
              >
                <p class="word__title">#{{ word }}</p>
              </div>
            </ng-container>
          </div>
          <!--  -->
          <div class="error__symbol" *ngIf="checkKeyWords">
            <p
              class="error__symbol-title"
              (click)="
                deleteKeyWords();
                inputKeyWords.value = this.keyWords.join(' ');
                keyWordsInput(inputKeyWords.value)
              "
            >
              <span>Видалити всі не правильні кілючові слова.</span>
            </p>
          </div>
        </div>
        <!-- ============================================================== -->
        <div class="new__item new__description">
          <div class="new__item-title">
            <p class="title">Опис товару*</p>
          </div>
          <mat-form-field
            class="example-full-width input-width-description"
            appearance="fill"
          >
            <mat-label>Опис товару</mat-label>
            <textarea
              matInput
              type="text"
              class="input-description"
              required
              #inputDescription
              [(ngModel)]="description"
              [minlength]="minLengthDescription"
              [maxlength]="maxLengthDescription"
            ></textarea>
          </mat-form-field>
          <!--  -->
          <div class="new__description-symbol">
            <span
              class="span__description"
              [ngClass]="{
                try__input:
                  description.length >= minLengthDescription &&
                  description.length <= maxLengthDescription,
                error__input: description.length > maxLengthDescription
              }"
            >
              Символів {{ description.length }}/{{ maxLengthDescription }}
            </span>
          </div>
          <!--  -->
        </div>
        <!-- ============================================================== -->
        <div class="new__item new__create">
          <div class="example-button-row">
            <button
              mat-raised-button
              color="primary"
              type="submit"
              *ngIf="!update"
              (click)="createProduct()"
              [disabled]="
                !imagesValidation ||
                nameProduct.length <= 5 ||
                !priceProduct ||
                actionProcent > minActionProcent ||
                counterProduct <= 0 ||
                statusNumber <= -1 ||
                sellerNumber <= -1 ||
                categoryNumber.length <= 1 ||
                !updateSelectValidity ||
                uniqueParamsNumber <= -1 ||
                lengthKeyWords > 200 ||
                description.length < 60 ||
                description.length > 5000
              "
            >
              Створити
            </button>
          </div>
          <!--  -->
          <button
            mat-raised-button
            color="primary"
            type="submit"
            *ngIf="update"
            (click)="upProduct()"
            [disabled]="
              updateProduct?.name === nameProduct &&
              updateProduct?.price === priceProduct &&
              updateProduct?.description === description &&
              !updateSelectValidity
            "
          >
            Зберегти
          </button>
        </div>
      </div>
      <!--  -->
      <div
        cdkDropList
        class="product__content-photo example-list"
        (cdkDropListDropped)="drop($event)"
      >
        <div
          class="img__preview example-box"
          *ngFor="let image of imagePreview"
          cdkDrag
        >
          <div class="example-custom-placeholder" *cdkDragPlaceholder></div>
          <img [src]="image" *ngIf="image !== undefined" />
          <img
            src="../../../../assets//img/300x300.png"
            *ngIf="image === undefined"
          />
        </div>
      </div>
    </div>
  </div>
</div>

<div class="select__popuap" *ngIf="popuapOnOff">
  <div class="select__popuap-content">
    <a (click)="popuapClose(0)" class="close"
      ><span class="material-symbols-outlined"> close </span></a
    >
    <!--  -->
    <div class="category__select-item" *ngIf="!oneCategory">
      <div class="category__title">
        <h2>Виберіть категорію</h2>
      </div>
      <!--  -->
      <div class="category__content">
        <div
          class="category__select-item-box"
          *ngFor="let categoryItem of categoryList; let idx = index"
          [ngClass]="{
            one__Box: 0 === idx,
            two__Box: 1 === idx,
            three__Box: 2 === idx,
            four__Box: 3 === idx,
            five__Box: 4 === idx,
            six__Box: 5 === idx,
            seven__Box: 6 === idx,
            eight__Box: 7 === idx,
            nine__Box: 8 === idx,
            ten__Box: 9 === idx,
            eleven__Box: 10 === idx,
            twelve__Box: 11 === idx
          }"
          (click)="selectCategoryPopuapStart(idx)"
        >
          <h2 class="box__title">{{ categoryItem.nameCategory }}</h2>
        </div>
      </div>
    </div>
    <!--  -->
    <div class="category" *ngIf="oneCategory">
      <div class="category-block">
        <ng-container *ngIf="oneCategory">
          <div
            class="block"
            *ngFor="let category of categoryList; let idx = index"
            [ngClass]="{ active__block: oneIndex === idx }"
            (click)="editOneCategory(idx)"
          >
            <h2 class="block__title">{{ category.nameCategory }}</h2>
          </div>
        </ng-container>
      </div>
      <!--  -->
      <div class="category-block-sub">
        <ng-container *ngIf="twoCategory">
          <div
            class="block-sub"
            *ngFor="
              let category of categoryList[oneIndex].nameListCategory;
              let idx = index
            "
            (click)="editTwoCategory(idx)"
            [ngClass]="{ active__block__sub: twoIndex === idx }"
          >
            <h2 class="block-sub__title">{{ category.subNameCategory }}</h2>
          </div>
        </ng-container>
      </div>
      <!--  -->
      <div class="category-block-sub-list">
        <ng-container
          *ngIf="
            threeCategory &&
            categoryList[oneIndex].nameListCategory[
              twoIndex === -1 ? 0 : twoIndex
            ].subNameListCategory[threeIndex === -1 ? 0 : threeIndex]
              .titleSubNameListCategory !== undefined
          "
        >
          <div
            class="block-sub-list"
            *ngFor="
              let category of categoryList[oneIndex].nameListCategory[twoIndex]
                .subNameListCategory;
              let idx = index
            "
            (click)="editThreeCategory(idx)"
            [ngClass]="{
              active__block__sub__list: threeIndex === idx
            }"
          >
            <h2 class="block-sub-list__title">
              {{ category.titleSubNameListCategory }}
            </h2>
          </div>
        </ng-container>
      </div>
    </div>
    <!--  -->
    <div class="example-button-row">
      <button
        mat-raised-button
        color="primary"
        *ngIf="oneCategory"
        [disabled]="
          categoryList[oneIndex].nameListCategory[
            twoIndex === -1 ? 0 : twoIndex
          ].subNameListCategory[threeIndex === -1 ? 0 : threeIndex]
            .titleSubNameListCategory !== undefined && threeIndex === -1
        "
        (click)="buttonSelectThisCategory()"
      >
        Вибрати категорію
      </button>
    </div>
  </div>
</div>
